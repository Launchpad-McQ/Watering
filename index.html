<!DOCTYPE HTML>
<html>
   <head>
	
      <script type="text/javascript">
        var ws;
        var state;
        // state.relayon and state.sensorval
        var message;

         function WebSocketTest()
         {
            if ("WebSocket" in window)
            {
               // Let us open a web socket
               //ws = new WebSocket("ws://laser.xkz.se:9998");
               ws = new WebSocket("ws://localhost:9998");
				
               // does thin when web socket is opened.
               ws.onopen = function()
               {
               };
               
              ws.onmessage = function (event) {
                    state = JSON.parse(event.data);
                    message = {relaynum: 0, duration: state.duration, turn:
                        false};

    var elmnt = document.createElement("li");
    var elmnt2 = document.createElement("li");
    var content1 = document.createTextNode(state.relayon);
    var content2 = document.createTextNode(state.sensorval);    
    elmnt.appendChild(content1);
    elmnt2.appendChild(content2);

    var item = document.getElementById("myList");
    item.replaceChild(elmnt, item.childNodes[0]);
    item.replaceChild(elmnt2, item.childNodes[1]);
            };
			
				
function myFunction() {
    elmnt = document.createElement("li");
    textnode = document.createTextNode("Water");
    content1 = document.createTextNode(state.relayon);
    content2 = document.createTextNode(state.sensorval);    
    elmnt.appendChild(content1);
    elmnt.appendChild(content2);

    var item = document.getElementById("myList");
    item.replaceChild(elmnt, item.childNodes[0]);
}






               ws.onclose = function()
               { 
                  // websocket is closed.
                  alert("Connection is closed..."); 
               };
					
               window.onbeforeunload = function(event) {
                  socket.close();
               };
            }
            
            else
            {
               // The browser doesn't support WebSocket
               alert("WebSocket NOT supported by your Browser!");
            }
         }
         function Relay(relaynum)
         {
                  // Web Socket is connected, send data using send()
             message.relaynum = relaynum;
             message.turn = true;
             ws.send(JSON.stringify(message));
              

         }
function dropmenu() {
    var x = document.getElementById("mySelect").value;
    document.getElementById("demo").innerHTML = x;
    message.duration = x;
    message.turn = false;
    ws.send(JSON.stringify(message));
}
      </script>
   </head>
   <body onload="WebSocketTest();">
   
      <div id="sse">
         <button onclick="Relay(0)">Relay0</button>
         <button onclick="Relay(1)">Relay1</button>
         <button onclick="Relay(2)">Relay2</button>
         <button onclick="Relay(3)">Relay3</button>
         <button onclick="Relay(4)">Relay4</button>
         <button onclick="Relay(5)">Relay5</button>
         <button onclick="Relay(6)">Relay6</button>
         <button onclick="Relay(7)">Relay7</button>
         <button onclick="Relay(8)">Relay8</button>
         <button onclick="Relay(9)">Relay9</button>
         <button onclick="Relay(10)">Relay10</button>
         <button onclick="Relay(11)">Relay11</button>
         <button onclick="Relay(12)">Relay12</button>
         <button onclick="Relay(13)">Relay13</button>
         <button onclick="Relay(14)">Relay14</button>
         <button onclick="Relay(15)">Relay15</button>
      </div>
      
<form onclick="dropmenu()">
Relay on time. (Time relay is turned on after click)
<select value="5" selected="5" id="mySelect">
  <option value="2">2 Seconds</option>
  <option value="5">5 Seconds</option>
  <option value="10">10 Seconds</option>
  <option value="20">20 Seconds</option>
</select>
</form>



<p id="demo"></p>




<ul id="myList"><li>Coffee</li><li>Tea</li></ul>





   </body>
</html>
